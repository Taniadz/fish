

{#all comment to post on page "single_post"#}
{% macro post_comment_macro(comment, dict_like) -%}
    <div id="comment{{ comment.id }}">
        <div class="left-image">
        {% if current_user.avatar.min %}
             <img class="img-inherited" src="{{ url_for('static',filename="media/" + comment.com_author.avatar_min) }}"/>
        {% else %}
             <img src="{{ url_for('static',filename="media/" + "min_icon-user-default.png") }}" width="40px"/>
        {% endif %}
        </div>
        <div class="description">

            <p class="ct-u-paddingBottom5">
                <span>{{ comment.com_author.username }} </span>
                - {{ comment.timestamp|datetime }}




            </p>
            <p>
                {% if comment.image %}
                    <img class="img-inherited" src="{{ url_for('static',filename="media/" + comment.image) }}"/>
                {% endif %}
                {{ comment.text }}
            </p>


                    <div class="under-box comment-under-box">
                        {{ popup_div_macro(comment.id, "like_comment ") }}
                        <div class="reaction-button">
                            <ul class="like-left like-inline">
                                <li>
                                    {% if current_user.is_authenticated %}

                                        {% if dict_like[comment.id] %}

                                            {% if dict_like[comment.id] == "like"%}
                                                <img class="liked" src="{{ url_for('static',filename="image/reaction-like.png" )}}"
                                                    obj_id={{comment.id}} url = "like_comment" />

                                            {% elif dict_like[comment.id] == "unlike"%}
                                                <img class="liked" src="{{ url_for('static',filename="image/reaction-unlike.png" )}}"
                                                    obj_id={{comment.id}} url = "like_comment"  />

                                            {% elif dict_like[comment.id] == "funny"%}
                                                <img class="liked" src="{{ url_for('static',filename="image/reaction-funny.png" )}}"
                                                    obj_id={{comment.id}} url = "like_comment" />

                                            {% elif dict_like[comment.id] == "angry"%}
                                                <img class="liked" src="{{ url_for('static',filename="image/reaction-angry.png" )}}"
                                                    obj_id={{comment.id}} url = "like_comment"  />
                                            {% endif %}
                                        {% else %}
                                            <img class="unliked"  src="{{ url_for('static',filename="image/not-reaction.png" )}}"
                                                                     url = "like_comment" obj_id={{comment.id}} />

                                        {% endif%}
                                    {% endif %}
                                </li>
                                <li><h4>like</h4></li>
                            </ul>
                        </div>
                        <div id="button_comment1" class="comment-button">
                            <ul>
                                <li>
                                    <i class="fa fa-comments-o" aria-hidden="true"></i>
                                </li>
{#                                 {% if current_user != comment.com_author %}#}
                                <li><h4 class="discussion" id="{{ comment.id }}"
                      user="{{ comment.com_author.username }}"
                      post_id = "{{ comment.post_id }}" >discussion</h4></li>

                                </ul>


{#            {% endif %}#}

                        </div>




                        <div class="comment-edit">
                            {% if current_user == comment.com_author %}

                                <div class="dropdown post_com_edit" id="edit{{ comment.id }}">

                                    <h4  class="dropdown-toggle " data-toggle="dropdown">
                                        <nav class="plus ct-Diamond ct-Diamond--motive"></nav>
                                        edit
                                    </h4>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="#" onclick="edit_comment(event, {{ comment.id }}, '/edit_post_comment');">
                                            <i class="fa fa-pencil-square-o" aria-hidden="true"></i>edit</a></li>
                                        <li><a href="#"
                                               onclick="delete_comment(event, {{ comment.id }}, '/delete_post_comment');">delete</a></li>

                                    </ul>
                                </div>

                            {% endif %}

                        </div>
                        <div class="comment-counter reaction-counter">
                            <ul>
                                <li>

                                    <span id="like_count_like_comment_{{comment.id}}">{{ comment.like_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-like.png" )}}" width=20/>
                                    <span id="unlike_count_like_comment_{{comment.id}}">{{ comment.unlike_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-unlike.png" )}}" width=20/>
                                    <span id="funny_count_like_comment_{{comment.id}}">{{ comment.funny_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-funny.png" )}}" width=20/>
                                    <span id="angry_count_like_comment_{{comment.id}}">{{ comment.angry_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-angry.png" )}}" width=20/>


                                </li>

                            </ul>
                        </div>

                    </div>

<div class=answer id="answer{{ comment.id }}">

                </div>
        </div>


{#            <p class="under_comment">#}
{#                {% if current_user.is_authenticated %}#}
{##}
{#                    {% if dict_like[comment.id] %}#}
{##}
{#                        <div class="smile-container">#}
{#                            <div class="parent_div">#}
{##}
{#                                {{ popup_div_macro(comment.id, "like_comment ") }}#}
{##}
{#                                {% if dict_like[comment.id] == "like" %}#}
{#                                    <img class="liked" src="{{ url_for('static',filename="image/like_smile.png" ) }}"#}
{#                                         obj_id={{ comment.id }} url = "like_comment" />#}
{##}
{#                                {% elif dict_like[comment.id] == "unlike" %}#}
{#                                    <img class="liked" src="{{ url_for('static',filename="image/unlike_smile.png" ) }}"#}
{#                                         obj_id={{ comment.id }} url = "like_comment"  />#}
{##}
{#                                {% elif dict_like[comment.id] == "funny" %}#}
{#                                    <img class="liked" src="{{ url_for('static',filename="image/funny.png" ) }}"#}
{#                                         obj_id={{ comment.id }} url = "like_comment" />#}
{##}
{##}
{#                                {% elif dict_like[comment.id] == "angry" %}#}
{#                                    <img class="liked" src="{{ url_for('static',filename="image/angry.png" ) }}"#}
{#                                         obj_id="{{ comment.id }}" url = "like_comment"  />#}
{##}
{##}
{#                                {% endif %}#}
{#                            </div>#}
{#                        </div>#}
{##}
{#                    {% else %}#}
{##}
{#                        <div class="smile-container">#}
{#                            <div class="parent_div">#}
{##}
{#                                {{ popup_div_macro(comment.id, "like_comment ") }}#}
{#                                <img class="unliked" src="{{ url_for('static',filename="image/gray.png" ) }}"#}
{#                                     url="like_comment" obj_id="{{ comment.id }}"/>#}
{#                            </div>#}
{#                        </div>#}
{##}
{#                    {% endif %}#}
{#                    <span id="like_count_like_comment_{{ comment.id }}">{{ comment.like_count }} </span>#}
{#                    <img class="smile" src="{{ url_for('static',filename="image/like_smile.png" ) }}" width=20/>#}
{#                    <span id="unlike_count_like_comment_{{ comment.id }}">{{ comment.unlike_count }} </span>#}
{#                    <img class="smile" src="{{ url_for('static',filename="image/unlike_smile.png" ) }}" width=20/>#}
{#                    <span id="funny_count_like_comment_{{ comment.id }}">{{ comment.funny_count }} </span>#}
{#                    <img class="smile" src="{{ url_for('static',filename="image/funny.png" ) }}" width=20/>#}
{#                    <span id="angry_count_like_comment_{{ comment.id }}">{{ comment.angry_count }} </span>#}
{#                    <img class="smile" src="{{ url_for('static',filename="image/angry.png" ) }}" width=20/>#}
{##}
{#                {% else %}#}
{#                    <span>{{ comment.like_count }}</span>&nbsp;#}
{#                    <img class="anon_like" src="{{ url_for('static',filename="image/white.png" ) }}"#}
{#                         width="20"/>#}
{#                {% endif %}#}
{##}
{##}
{#            <span class="comment_inf">#}
{#                                Comment by {{ comment.com_author.username }} [{{ comment.timestamp }}]#}
{#                            </span>#}
{#            {% if current_user != comment.com_author %}#}
{#                <span class="discussion" id="{{ comment.id }}"#}
{#                      user="{{ comment.com_author.username }}"#}
{#                      post_id = "{{ comment.post_id }}"  >Discussion</span>#}
{#                <div class=answer id="answer{{ comment.id }}" style="display: none">#}
{##}
{#                </div>#}
{#            {% endif %}#}
{#            </p>#}
{#        </div>#}

    </div>
{%- endmacro %}


{#all comment to product on page "single_product"#}
{% macro product_comment_macro(comment, dict_like) -%}
    <div class="one_comment" id="comment{{ comment.id }}">
        {% if current_user.avatar_min %}
            <a href="{{ url_for("user", username=comment.com_author.username) }}"> <img
                    src="{{ url_for('static',filename="media/" + comment.com_author.avatar_min) }}"
                    class="leftimg"/></a>
        {% endif %}

        <div class="description">
            <div class="comment_image">
                {% if comment.image %}
                    <img src="{{ url_for('static',filename="media/" + comment.image) }}" width=100px/>
                {% endif %}
            </div>
            <span class="comment_text">
                                {{ comment.text }}
                            </span><br>
            <p class="under_comment">
                {% if current_user.is_authenticated %}
                    {% if dict_like[comment.id] %}

                        <div class="smile-container">
                            <div class="parent_div">

                                {{ popup_div_macro(comment.id, "like_prodcomment ") }}

                                {% if dict_like[comment.id] == "like" %}
                                    <img class="liked" src="{{ url_for('static',filename="image/like_smile.png" ) }}"
                                         obj_id="{{ comment.id }}" url = "like_prodcomment" />

                                {% elif dict_like[comment.id] == "unlike" %}
                                    <img class="liked" src="{{ url_for('static',filename="image/unlike_smile.png" ) }}"
                                         obj_id="{{ comment.id }}" url = "like_prodcomment"  />

                                {% elif dict_like[comment.id] == "funny" %}
                                    <img class="liked" src="{{ url_for('static',filename="image/funny.png" ) }}"
                                         obj_id="{{ comment.id }}" url = "like_prodcomment" />


                                {% elif dict_like[comment.id] == "angry" %}
                                    <img class="liked" src="{{ url_for('static',filename="image/angry.png" ) }}"
                                         obj_id="{{ comment.id }}" url = "like_prodcomment"  />


                                {% endif %}
                            </div>
                        </div>

                    {% else %}

                        <div class="smile-container">
                            <div class="parent_div">

                                {{ popup_div_macro(comment.id, "like_prodcomment ") }}
                                <img class="unliked" src="{{ url_for('static',filename="image/gray.png" ) }}"
                                     url="like_prodcomment" obj_id="{{ comment.id }}"/>
                            </div>
                        </div>

                    {% endif %}
                    <span id="like_count_like_prodcomment_{{ comment.id }}">{{ comment.like_count }} </span>
                    <img class="smile" src="{{ url_for('static',filename="image/like_smile.png" ) }}" width=20/>
                    <span id="unlike_count_like_prodcomment_{{ comment.id }}">{{ comment.unlike_count }} </span>
                    <img class="smile" src="{{ url_for('static',filename="image/unlike_smile.png" ) }}" width=20/>
                    <span id="funny_count_like_prodcomment_{{ comment.id }}">{{ comment.funny_count }} </span>
                    <img class="smile" src="{{ url_for('static',filename="image/funny.png" ) }}" width=20/>
                    <span id="angry_count_like_prodcomment_{{ comment.id }}">{{ comment.angry_count }} </span>
                    <img class="smile" src="{{ url_for('static',filename="image/angry.png" ) }}" width=20/>


                {% else %}
                    <span>{{ comment.vote_count }}</span>&nbsp;
                    <img class="anon_like" src="{{ url_for('static',filename="image/white.png" ) }}"
                         width="20"/>
                {% endif %}


            <span class="comment_inf">
                                Comment by {{ comment.com_author.username }} [{{ comment.timestamp }}]
                            </span>
            {% if current_user != comment.com_author %}
                <span class="discussion" id="{{ comment.id }}"
                      user="{{ comment.com_author.username }}"
                        product_id="{{ comment.product_id }}">Discussion</span>
                <div class=answer id="answer{{ comment.id }}" style="display: none">

                </div>
            {% endif %}
            </p>
        </div>
        {% if current_user == comment.com_author %}
            <div class="btn-group btn-xs prod_com_edit" id="edit{{ comment.id }}">
                <button type="button" class="btn btn-default btn-xs dropdown-toggle " data-toggle="dropdown">Edit <span
                        class="caret"></span></button>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="#" onclick="edit_comment(event, {{ comment.id }}, '/edit_prod_comment');">edit</a></li>
                    <li><a href="#" onclick="delete_comment(event, {{ comment.id }}, '/delete_prod_comment');">delete</a>
                    </li>

                </ul>
            </div>

        {% endif %}

    </div>
{%- endmacro %}


{% macro comment_edit(url, comment) -%}
    <form action="{{ url_for( url, comment_id=comment.id ) }}" method="post"
          enctype="multipart/form-data" class="form-horizontal edit_comment">
        <p>
            {{ form.text(class_="form-control my_textarea", rows="2") }}
            {{ form.file }}<br>


            {% if form.errors %}
                <ul class=errors>
                    {% for error in form.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </p>


        <div class="control-group">
            <div class="controls">
                <button type="submit" class="btn btn-success">Add comment</button>
            </div>
        </div>
    </form>
{%- endmacro %}


{% macro posts_macro(post, dict, list_of_favourite) -%}

   <div class="col-sm-4 ct-js-blogMasonry-item" >

                                <article class="ct-articleBox">

                                    <a href="{{ url_for('singlepost', postid=post.id) }}"><h5>{{ post.title }}</h5></a>
                                    <p class="ct-u-motiveLight">
                                        By
                                        <a href="#">{{ post.author.username }}</a>
                                        on
                                        {{ post.published_at|datetime }}

                                    </p>
                                    <p>
                                        {% if post.image %}
                                                                                    <img  src="{{ url_for('static',filename="media/" + post.image) }}"/><br>

                                            {{ post.body|truncate(70, True) }}

                                        {% else %}
                                        {{ post.body|truncate(150, True) }}
                                        {% endif %}
                                    </p>
                                <div class="under-box">
                                     <div class="reaction-counter grid">

                                        <span id="like_count_like_post_{{post.id}}">{{ post.like_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-like.png" )}}" width=20/>
                                        <span id="unlike_count_like_post_{{post.id}}">{{ post.unlike_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-unlike.png" )}}" width=20/>
                                        <span id="funny_count_like_post_{{post.id}}">{{ post.funny_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-funny.png" )}}" width=20/>
                                        <span id="angry_count_like_post_{{post.id}}">{{ post.angry_count }} </span><img class="smile" src="{{ url_for('static',filename="image/reaction-angry.png" )}}" width=20/>

                                    </div>
                                    <div class="favourite-button grid">
                                        <ul class="list-unstyled">
                                            <li>


                                                {% if if_favorite %}
                                                    <i class="fa fa-star favourite" id="{{post.id}}" aria-hidden="true"></i>
                                                {% else%}
                                                    <i class="fa fa-star-o not-favourite" id="{{post.id}}" aria-hidden="true"></i>
                                                {% endif %}
                                            </li>

                                        </ul>
                                    </div>
                                </div>


                                </article>
                            </div>
{%- endmacro %}



{#generate product_boxes#}
{% macro products_macro(product, dict, list_of_favourite, md ) -%}
    <div class="product_box col-xs-12 col-sm-5 col-md-{{ md }}">
        <div class="product_title">
            <h4>
                <a href="{{ url_for('singleproduct', product_id=product.id) }}">{{ product.title|truncate(10, True) }}</a>
            </h4> <br>
        </div>
        <div class="is_image product">
        {% if product.image %}
            <img src="{{ url_for('static',filename="media/" + product.image) }}"/><br>
        {% else %}
            <img src="{{ url_for('static',filename="image/default_product.jpg") }}" width="100px"/><br>
        {% endif %}
        </div>

        <div class="product_description">
            {{ product.description|truncate(50, True) }}
        </div>
        <div class="price">

            {{ product.price }}


        </div>


        <span>   Write {{ product.product_author.username }} </span><br>
        <hr class="myhrline product"/>


        {% if dict[product.id] %}

            <div class="smile-container">
                <div class="parent_div">

                    {{ popup_div_macro(product.id, "like_product ") }}

                    {% if dict[product.id] == "like" %}
                        <img class="liked" src="{{ url_for('static',filename="image/like_smile.png" ) }}"
                             obj_id="{{ product.id }}" url = "like_product" />

                    {% elif dict[product.id] == "unlike" %}
                        <img class="liked" src="{{ url_for('static',filename="image/unlike_smile.png" ) }}"
                             obj_id="{{ product.id }}" url = "like_product"  />

                    {% elif dict[product.id] == "funny" %}
                        <img class="liked" src="{{ url_for('static',filename="image/funny.png" ) }}"
                             obj_id="{{ product.id }}" url = "like_product" />


                    {% elif dict[product.id] == "angry" %}
                        <img class="liked" src="{{ url_for('static',filename="image/angry.png" ) }}"
                             obj_id="{{ product.id }}" url = "like_product"  />


                    {% endif %}
                </div>
            </div>

        {% else %}

            <div class="smile-container">
                <div class="parent_div">

                    {{ popup_div_macro(product.id, "like_product ") }}
                    <img class="unliked" src="{{ url_for('static',filename="image/gray.png" ) }}"
                         url="like_product" obj_id="{{ product.id }}"/>
                </div>
            </div>

        {% endif %}
        <span id="like_count_like_product_{{ product.id }}">{{ product.like_count }} </span><img class="smile"
                                                                                                 src="{{ url_for('static',filename="image/like_smile.png" ) }}"
                                                                                                 width=20/>
        <span id="unlike_count_like_product_{{ product.id }}">{{ product.unlike_count }} </span><img class="smile"
                                                                                                     src="{{ url_for('static',filename="image/unlike_smile.png" ) }}"
                                                                                                     width=20/>
        <span id="funny_count_like_product_{{ product.id }}">{{ product.funny_count }} </span><img class="smile"
                                                                                                   src="{{ url_for('static',filename="image/funny.png" ) }}"
                                                                                                   width=20/>
        <span id="angry_count_like_product_{{ product.id }}">{{ product.angry_count }} </span><img class="smile"
                                                                                                   src="{{ url_for('static',filename="image/angry.png" ) }}"
                                                                                                   width=20/>



        {% if product in list_of_favourite %}
            <span class="star product" id="star_gold{{ product.id }}">Delete_saved</span>&nbsp;
            <img class="product" id="gold_star" src="{{ url_for('static',filename="image/gold_star.png" ) }}"
                 width="20" product_id="{{ product.id }}"/></a>
        {% else %}
            <span class="star product" id="star_white{{ product.id }}">Add_to_saved</span>&nbsp;
            <img class="product" id="white_star" src="{{ url_for('static',filename="image/white_star.png" ) }}"
                 width="20" product_id="{{ product.id }}"/></a>
        {% endif %}


    </div>

{%- endmacro %}



{#generate div with four different reaction when mouse hover on smile#}
{% macro popup_div_macro(id, url) -%}
    <div class="popup-div" obj_id={{ id }} url={{ url }}>
        <img class="smile" src="{{ url_for('static',filename="image/reaction-like.png" ) }}" obj_id={{ id }} width="40"
             type="like" url={{ url }}/>
        <img class="smile" src="{{ url_for('static',filename="image/reaction-unlike.png" ) }}" obj_id={{ id }} width="40"
             type="unlike" url={{ url }}/>
        <img class="smile" src="{{ url_for('static',filename="image/reaction-funny.png" ) }}" obj_id={{ id }} width="40"
             type="funny" url={{ url }}/>
        <img class="smile" src="{{ url_for('static',filename="image/reaction-angry.png" ) }}" obj_id={{ id }} width="45"
             type="angry" url={{ url }}/>
    </div>
{% endmacro %}


{% macro render_field(field) %}
    {{ field.label }}
    {% if field.errors %}
        <ul class="errors">
            {% for error in field.errors %}
                <li>{{ error }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    {{ field(**kwargs)|safe }}
{% endmacro %}